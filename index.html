<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Synth Components Demo</title>
    <style>
:root {
  font-family: sans-serif;
}

* {
  box-sizing: border-box;
}

audio-out {
  max-width: 400px;
  margin: auto;
}
    </style>
  </head>
  <body>

    <audio-out>

      <!-- monophonic keyboard synth -->
      <gain-tile gain="0" send="delay"> 
        <!-- set volume from the O2 volume slider -->
        <midi-vca slot="gain" midicontroller="24" value="1"></midi-vca>
        <!-- filter, controlled by O2 knob C2 -->
        <filter-tile type="bandpass">
          <midi-vca slot="frequency" value="800" min="100" max="1600" midicontroller="17"></midi-vca>
          <!-- envelope automatically cues on MIDI channel 0 -->
          <envelope-tile attack="0" decay=".05" sustain=".4" release=".5">
            <!-- actual oscillator -->
            <osc-tile waveform="sawtooth">
              <!-- pitch and frequency set from keyboard -->
              <midi-pitchbend slot="detune"></midi-pitchbend>
              <midi-note-frequency slot="frequency"></midi-note-frequency>
            </osc-tile>
            <!-- a little noise for grit -->
          </envelope-tile>
        </filter-tile>
      </gain-tile>

      <!-- synclavier echo -->
      <gain-tile gain=".5">
        <delay-tile time=".05">
          <aux-return bus="delay"></aux-return>
        </delay-tile>
      </gain>

      <!-- noise pad, controlled by O2 knob C1 -->
      <filter-tile>
        <midi-vca slot="frequency" midicontroller="16" min="120" max="400" value="140"></midi-vca>
        <noise-tile></noise-tile>
      </filter-tile>
      
      <!-- additional noise pad, oscillating filter (engine hum) -->
      <filter-tile frequency="120">
        <gain-tile gain="20" slot="frequency">
          <osc-tile frequency=".73"></osc-tile>
        </gain-tile>
        <noise-tile send="noise"></noise-tile>
      </filter-tile>

      <gain-tile gain=".5" send="pad">
        <synth-voice waveform="sine" attack="1" release="2"></synth-voice>
      </gain-tile>

      <!-- add a little chorus to our sine pad -->
      <!-- <gain-tile gain=".2"> -->
        <delay-tile time=".01">
          <gain-tile gain=".01" slot="delayTime">
            <osc-tile frequency=".1"></osc-tile>
          </gain-tile>
          <aux-return bus="pad"></aux-return>
        </delay-tile>
      <!-- </gain-tile> -->
      

    </audio-out>

    <script type="module">
      import "./src/adsr-tile.js";
      import "./src/audio-out.js";
      import "./src/aux-bus.js";
      import "./src/delay-tile.js";
      import "./src/filter-tile.js";
      import "./src/gain-tile.js";
      import "./src/midi-tiles.js";
      import "./src/noise-tile.js";
      import "./src/osc-tile.js";
      import "./src/synth-voice.js";
    </script>
  </body>
</html>